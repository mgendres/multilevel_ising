(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     32999,        857]
NotebookOptionsPosition[     31708,        811]
NotebookOutlinePosition[     32064,        827]
CellTagsIndexPosition[     32021,        824]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Defaults", "Section",
 CellChangeTimes->{{3.628265176547806*^9, 3.628265177894039*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "path", "=", 
   "\"\</Users/endres/Documents/MIT/research/bdeop/endres/ising/code_v0.6/\
tests/tuning/\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.571108171634748*^9, 3.571108192771062*^9}, {
   3.5711151134935503`*^9, 3.571115113573044*^9}, 3.6282606862851152`*^9, {
   3.628272075910886*^9, 3.628272080074477*^9}, {3.628276895504327*^9, 
   3.628276895593114*^9}, {3.6284211092708473`*^9, 3.628421117419148*^9}, {
   3.628433428681162*^9, 3.628433430290649*^9}, {3.6284426262855797`*^9, 
   3.628442627282104*^9}, {3.6288536812724037`*^9, 3.6288536813348627`*^9}, {
   3.6288537752162113`*^9, 3.6288537763632402`*^9}, {3.628952238947384*^9, 
   3.628952254133895*^9}, 3.62898354780791*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "NotebooksPath", "=", 
   "\"\</Users/endres/Documents/MIT/research/bdeop/endres/ising/code_v0.6/\
Mathematica/\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.595851658620761*^9, 3.595851705410939*^9}, {
  3.62887484536057*^9, 3.6288748485901403`*^9}}],

Cell[BoxData[
 RowBox[{"NotebookEvaluate", "[", 
  RowBox[{"NotebooksPath", "<>", "\"\</ising.nb\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.628874868484182*^9, 3.6288748723633537`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scans", "Section",
 CellChangeTimes->{{3.5711114184020767`*^9, 3.571111418992846*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"levels", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<magnetization\>\"", ",", "\"\<hamiltonian\>\""}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6289835833208313`*^9, 3.628983585784747*^9}, {
   3.628983783088613*^9, 3.628983808099209*^9}, 3.62898426312921*^9, 
   3.628985088172801*^9, 3.628985242471184*^9, 3.628985756637635*^9, 
   3.62899029723955*^9, 3.628996227552772*^9, 3.6290290779850817`*^9, 
   3.629217131738296*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Op", "[", "\"\<magnetization\>\"", "]"}], "=", "Abs"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Op", "[", "\"\<hamiltonian\>\"", "]"}], "=", 
   RowBox[{"#", "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.628983965641543*^9, 3.6289840363060083`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"opLabel", "[", "\"\<magnetization\>\"", "]"}], "=", "\"\<M\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"opLabel", "[", "\"\<hamiltonian\>\"", "]"}], "=", "\"\<H\>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.628984403736772*^9, 3.6289844315242443`*^9}}],

Cell[BoxData[
 RowBox[{"Lvals", "=", 
  RowBox[{"2", "^", 
   RowBox[{"Range", "[", "levels", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.628990310140027*^9, {3.6290273274580393`*^9, 3.629027348794207*^9}, {
   3.629029080555229*^9, 3.629029083735793*^9}, {3.629029153220089*^9, 
   3.629029160601694*^9}, {3.62914026090527*^9, 3.629140263537222*^9}, {
   3.629217135274907*^9, 3.629217135430148*^9}, {3.629287010832265*^9, 
   3.629287017487073*^9}, {3.629456176429699*^9, 3.629456176569989*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rawDat", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"path", "<>", "\"\</data_\>\"", "<>", 
        RowBox[{"ToString", "[", "L", "]"}], "<>", "\"\</\>\"", "<>", "o", 
        "<>", "\"\<_\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       "\"\<Table\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "L", ",", "\"\<, \>\"", ",", "o", ",", "\"\<, \>\"", ",", "i", ",", 
      "\"\< : \>\"", ",", 
      RowBox[{"Dimensions", "[", "rawDat", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Kvals", "[", 
      RowBox[{"L", ",", "o", ",", "i"}], "]"}], "=", 
     RowBox[{"Tally", "[", 
      RowBox[{"rawDat", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dat", "[", 
      RowBox[{"L", ",", "o", ",", "i"}], "]"}], "=", 
     RowBox[{"GatherBy", "[", 
      RowBox[{"rawDat", ",", "First"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"L", ",", "o", ",", "i"}], "]"}], "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{
          RowBox[{"Op", "[", "o", "]"}], "@", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"L", ",", "o", ",", "i"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dx", "[", 
      RowBox[{"L", ",", "o", ",", "i"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StandardDeviation", "[", 
          RowBox[{
           RowBox[{"Op", "[", "o", "]"}], "@", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
        RowBox[{"dat", "[", 
         RowBox[{"L", ",", "o", ",", "i"}], "]"}]}], "]"}], "/", 
      RowBox[{"Sqrt", "@", 
       RowBox[{
        RowBox[{"Kvals", "[", 
         RowBox[{"L", ",", "o", ",", "i"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"o", ",", "ops"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"L", ",", "Lvals"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.57110817668048*^9, 3.571108218393017*^9}, {
   3.5711083779478416`*^9, 3.5711083854282*^9}, {3.57110856096128*^9, 
   3.571108561536936*^9}, {3.628260698600623*^9, 3.6282607193332977`*^9}, {
   3.628260961122596*^9, 3.628260961286263*^9}, {3.6284623666942387`*^9, 
   3.628462367359215*^9}, {3.62852952529561*^9, 3.628529543123418*^9}, {
   3.628529650072651*^9, 3.628529656429935*^9}, {3.628530115898735*^9, 
   3.628530115937604*^9}, {3.628530348837145*^9, 3.6285303488826437`*^9}, {
   3.628531412151258*^9, 3.628531684166624*^9}, {3.6285317141892223`*^9, 
   3.628531722263544*^9}, {3.6285320160029182`*^9, 3.628532017576861*^9}, {
   3.62853272780265*^9, 3.628532728018015*^9}, 3.6285329419723682`*^9, {
   3.628853753025025*^9, 3.62885375703747*^9}, {3.628853853597343*^9, 
   3.6288538621951923`*^9}, {3.628962747246759*^9, 3.6289627651168833`*^9}, {
   3.628983578838141*^9, 3.628983717495008*^9}, {3.628983749078657*^9, 
   3.628983767716297*^9}, {3.628983820188992*^9, 3.628983920447528*^9}, {
   3.628984050026265*^9, 3.628984145120391*^9}, {3.628984195645108*^9, 
   3.628984253683826*^9}, {3.628990304631459*^9, 3.6289903054891863`*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Print", "@", 
     RowBox[{"ErrorListPlot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Kvals", "[", 
              RowBox[{"L", ",", "o", ",", "i"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"L", ",", "o", ",", "i"}], "]"}], ",", 
            RowBox[{"dx", "[", 
             RowBox[{"L", ",", "o", ",", "i"}], "]"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.0"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<K\>\"", ",", 
          RowBox[{"opLabel", "[", "o", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Black", ",", "Dashed", ",", "Thick", ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Kcrit", ",", 
                 RowBox[{"-", "2"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Kcrit", ",", "2"}], "}"}]}], "}"}], "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"\"\<L = \>\"", "<>", 
                RowBox[{"ToString", "[", "L", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"0.85", ",", "0.15"}], "}"}]}], "]"}], ",", "22"}], 
            "]"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"o", ",", "ops"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"L", ",", "Lvals"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.628261778093609*^9, 3.628261794514036*^9}, {
   3.628261825317527*^9, 3.628261829987404*^9}, {3.6282620121933327`*^9, 
   3.628262019482378*^9}, {3.6282620835957613`*^9, 3.628262086157875*^9}, {
   3.628262243289303*^9, 3.6282622441939297`*^9}, {3.628265189164727*^9, 
   3.628265191249741*^9}, {3.628268191355854*^9, 3.6282681997825823`*^9}, {
   3.628268392991642*^9, 3.628268393138619*^9}, {3.6282684259692698`*^9, 
   3.628268426122669*^9}, 3.6282685091215277`*^9, {3.6283523552324257`*^9, 
   3.628352371506563*^9}, {3.628421359977343*^9, 3.628421377320075*^9}, {
   3.628421792368539*^9, 3.628421806588106*^9}, {3.628421874743682*^9, 
   3.6284218810896683`*^9}, {3.6284347900780993`*^9, 3.62843481203584*^9}, 
   3.628435404391715*^9, {3.628462404469377*^9, 3.62846241723277*^9}, {
   3.6285316997979097`*^9, 3.6285317714900627`*^9}, {3.628531834567464*^9, 
   3.628531853487652*^9}, {3.628531891603619*^9, 3.628531918562954*^9}, {
   3.62853195605017*^9, 3.628531978485783*^9}, {3.6285338729435997`*^9, 
   3.628533886113824*^9}, 3.6288536346589127`*^9, {3.628984189700162*^9, 
   3.628984190309259*^9}, {3.628984274265806*^9, 3.628984391256115*^9}, {
   3.628984438762871*^9, 3.6289844409310007`*^9}, {3.62898449655793*^9, 
   3.628984496721547*^9}, {3.62898484060421*^9, 3.628984957154304*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reweight", "Section",
 CellChangeTimes->{{3.628528080849646*^9, 3.628528083125559*^9}, {
  3.62914029167765*^9, 3.6291402928100557`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xReweight", "[", 
   RowBox[{
    RowBox[{"K_", "?", "NumericQ"}], ",", 
    RowBox[{"L_", "?", "NumericQ"}], ",", "o_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k", ",", "j", ",", "h", ",", "v", ",", "op"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{
       RowBox[{"Kvals", "[", 
        RowBox[{"L", ",", "o", ",", "i"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "@", 
         RowBox[{"First", "@", 
          RowBox[{"Position", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Min", "[", "#", "]"}]}], "]"}]}]}], "&"}], "@", 
       RowBox[{"Abs", "[", 
        RowBox[{"k", "-", "K"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"h", "=", 
      RowBox[{
       RowBox[{"dat", "[", 
        RowBox[{"L", ",", "\"\<hamiltonian\>\"", ",", 
         RowBox[{"2", 
          RowBox[{"Floor", "[", 
           RowBox[{"i", "/", "2"}], "]"}]}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "All", ",", "2"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"op", "=", 
      RowBox[{
       RowBox[{"Op", "[", "o", "]"}], "@", 
       RowBox[{
        RowBox[{"dat", "[", 
         RowBox[{"L", ",", "o", ",", "i"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "All", ",", "2"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"Floor", "[", 
          RowBox[{"i", "/", "2"}], "]"}]}], ")"}], 
       RowBox[{"L", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"op", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"K", "-", 
              RowBox[{"k", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "v", " ", "h"}], 
           "]"}]}], "]"}], "/", 
        RowBox[{"Total", "[", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"K", "-", 
             RowBox[{"k", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "v", " ", "h"}], "]"}],
          "]"}]}], ")"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.628986646232325*^9, 3.628986726268301*^9}, {
   3.628986762940206*^9, 3.6289867913185596`*^9}, {3.628986950315599*^9, 
   3.6289869771273813`*^9}, {3.628987009943488*^9, 3.628987013707657*^9}, {
   3.628987075732718*^9, 3.628987233978985*^9}, {3.628987316789353*^9, 
   3.628987361764791*^9}, {3.62898739650603*^9, 3.6289877286432047`*^9}, {
   3.628987885292157*^9, 3.6289879086277018`*^9}, 3.628988012065077*^9, 
   3.628990254397327*^9}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"xReweight", "[", 
    RowBox[{"K", ",", 
     RowBox[{"Lvals", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], ",", "\"\<magnetization\>\"", ",", 
     "2"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"K", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.628987369231512*^9, 3.628987388667077*^9}, {
   3.628987485023161*^9, 3.628987522931128*^9}, {3.6289875956427317`*^9, 
   3.628987602589306*^9}, {3.628987646018715*^9, 3.628987647438128*^9}, {
   3.628987752488175*^9, 3.628987767530386*^9}, 3.628987913760869*^9, {
   3.6289880364412403`*^9, 3.628988060488038*^9}, 3.62899022430859*^9, 
   3.628990262966838*^9, {3.628991333586809*^9, 3.6289913338463297`*^9}, {
   3.628992613992661*^9, 3.628992634366754*^9}, {3.629030193431436*^9, 
   3.629030193701117*^9}, {3.629140306841194*^9, 3.6291403119133368`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matching", "Section",
 CellChangeTimes->{{3.628952738012401*^9, 3.6289527410838757`*^9}, {
  3.628957051341618*^9, 3.628957052003339*^9}, {3.62896263832944*^9, 
  3.62896264007659*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rl", "[", "K_", "]"}], ":=", 
  RowBox[{
   RowBox[{"3.2090432488719616", "/", "8"}], 
   RowBox[{"Log", "[", 
    RowBox[{"Cosh", "[", 
     RowBox[{"4.0", "K"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rg", "[", "K_", "]"}], ":=", "K"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", "K_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"K", "<", "Kcrit"}], ",", 
    RowBox[{"Rl", "[", "K", "]"}], ",", 
    RowBox[{"Rg", "[", "K", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.628960990709177*^9, 3.628961041887492*^9}, {
  3.628961169334519*^9, 3.628961171363838*^9}, {3.628961210429689*^9, 
  3.628961211688517*^9}, {3.62896131926534*^9, 3.628961325832348*^9}, {
  3.628961966680356*^9, 3.62896199233617*^9}, {3.628964649509861*^9, 
  3.628964664619103*^9}, {3.628964704546914*^9, 3.6289647047696543`*^9}, {
  3.628990420088853*^9, 3.628990439138773*^9}}],

Cell[CellGroupData[{

Cell["Coupling matching", "Subsection",
 CellChangeTimes->{{3.6289626455795937`*^9, 3.628962650260696*^9}, {
  3.6289959639232807`*^9, 3.628995971285647*^9}}],

Cell[BoxData[
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rtab", "[", 
        RowBox[{"L", ",", "o", ",", "i"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"K", ",", 
           RowBox[{"z", "/.", 
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"xReweight", "[", 
                RowBox[{"K", ",", "L", ",", "o", ",", 
                 RowBox[{
                  RowBox[{"2", "i"}], "+", "1"}]}], "]"}], "==", 
               RowBox[{"xReweight", "[", 
                RowBox[{"z", ",", 
                 RowBox[{"L", "/", 
                  RowBox[{"2", "^", "i"}]}], ",", "o", ",", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"2", "i"}], "+", "2"}], ",", "4"}], "]"}]}], 
                "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"R", "[", "K", "]"}]}], "}"}]}], "]"}]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"K", ",", "0", ",", "1.0", ",", "0.01"}], "}"}]}], "]"}]}], 
      ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"o", ",", "ops"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"L", ",", 
       RowBox[{"Drop", "[", 
        RowBox[{"Lvals", ",", "1"}], "]"}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"L", ",", "o", ",", "i"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6289525714140053`*^9, 3.628952628798627*^9}, {
   3.6289533089256897`*^9, 3.628953319536326*^9}, {3.6289533747303257`*^9, 
   3.6289534945997963`*^9}, {3.628953532057774*^9, 3.6289535358557034`*^9}, {
   3.628953676339541*^9, 3.628953678689631*^9}, {3.628954146398638*^9, 
   3.628954155648293*^9}, {3.628954243839484*^9, 3.628954330837945*^9}, {
   3.628954368725305*^9, 3.628954439640161*^9}, {3.628954477520399*^9, 
   3.628954477599176*^9}, {3.6289545669987907`*^9, 3.6289545884621353`*^9}, {
   3.6289546200315037`*^9, 3.628954630798015*^9}, 3.628954719725144*^9, 
   3.6289558427973013`*^9, 3.6289563894727163`*^9, {3.628960574690773*^9, 
   3.628960620485153*^9}, {3.628960653398039*^9, 3.6289606543561296`*^9}, {
   3.6289608226161413`*^9, 3.6289608249716797`*^9}, {3.628960881004324*^9, 
   3.6289608811093903`*^9}, 3.6289609514158087`*^9, {3.628961072852154*^9, 
   3.628961079068378*^9}, {3.628961112441279*^9, 3.628961150011142*^9}, {
   3.628961201948926*^9, 3.6289612171437893`*^9}, {3.628961329784193*^9, 
   3.628961331885174*^9}, {3.628990457834854*^9, 3.628990500644373*^9}, {
   3.6289924523608513`*^9, 3.628992458242692*^9}, {3.628992560375705*^9, 
   3.628992596367806*^9}, {3.628993265539029*^9, 3.6289932990890007`*^9}, {
   3.628993408616057*^9, 3.628993609517583*^9}, {3.6289947112887983`*^9, 
   3.628994717224657*^9}, 3.629027898430084*^9, {3.629140342035676*^9, 
   3.629140365454734*^9}, {3.629217803165615*^9, 3.629217844983225*^9}, {
   3.629218019527911*^9, 3.629218020540564*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Join", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Rtab", "[", 
         RowBox[{"L", ",", "\"\<magnetization\>\"", ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", 
          RowBox[{"Drop", "[", 
           RowBox[{"Lvals", ",", "2"}], "]"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R", "[", "K", "]"}], ",", 
       RowBox[{"Rl", "[", "K", "]"}], ",", 
       RowBox[{"Rg", "[", "K", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Thick", ",", "Black"}], "}"}]}], "}"}]}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Gray", ",", "Dashed", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Kcrit", ",", 
            RowBox[{"-", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Kcrit", ",", "Kcrit"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "Kcrit"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Kcrit", ",", "Kcrit"}], "}"}]}], "}"}], "]"}]}], "}"}], 
     "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<K\>\"", ",", "\"\<\!\(\*SubscriptBox[\(R\), \(M\)]\)(K)\>\""}], 
     "}"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.62895334028578*^9, 3.628953345876294*^9}, {
   3.628953437611755*^9, 3.628953441801078*^9}, {3.628953552453524*^9, 
   3.628953601695829*^9}, {3.628953663231966*^9, 3.628953693458804*^9}, {
   3.628954334326968*^9, 3.6289543715955267`*^9}, {3.628954413061153*^9, 
   3.628954452601171*^9}, 3.628954688354249*^9, {3.628954977400296*^9, 
   3.628954985776758*^9}, 3.6289553563589973`*^9, {3.628955559385429*^9, 
   3.628955568548443*^9}, {3.62895745145194*^9, 3.628957469486224*^9}, {
   3.628961698867775*^9, 3.628961699825142*^9}, {3.628961944609858*^9, 
   3.628961959007367*^9}, {3.628961998046176*^9, 3.6289620922446012`*^9}, {
   3.628962251905821*^9, 3.6289622697669687`*^9}, {3.6289929397135*^9, 
   3.628992943867372*^9}, {3.628995990435775*^9, 3.628995993375146*^9}, {
   3.628996057374226*^9, 3.628996111706064*^9}, {3.628996152282166*^9, 
   3.628996200835125*^9}, 3.629020969716035*^9, {3.629021008416106*^9, 
   3.6290210180181847`*^9}, {3.629021075157933*^9, 3.629021189940446*^9}, {
   3.629029144435334*^9, 3.629029171291094*^9}, {3.6290312411112623`*^9, 
   3.6290312519888*^9}, {3.629031297399519*^9, 3.62903130727805*^9}, 
   3.629031530771082*^9, {3.629031594854289*^9, 3.629031600925562*^9}, 
   3.6291403986869097`*^9, 3.629221598481145*^9, {3.62922167732128*^9, 
   3.6292218147241573`*^9}, {3.629286996108759*^9, 3.6292870001789017`*^9}, 
   3.6292870733326397`*^9, {3.629464700480538*^9, 3.629464700608385*^9}, {
   3.6294648874418993`*^9, 3.629464908090974*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Join", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Rtab", "[", 
         RowBox[{"L", ",", "\"\<magnetization\>\"", ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", 
          RowBox[{"Take", "[", 
           RowBox[{"Lvals", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R", "[", "K", "]"}], ",", 
       RowBox[{"Rl", "[", "K", "]"}], ",", 
       RowBox[{"Rg", "[", "K", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Thick", ",", "Black"}], "}"}]}], "}"}]}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Gray", ",", "Dashed", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Kcrit", ",", 
            RowBox[{"-", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Kcrit", ",", "Kcrit"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "Kcrit"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Kcrit", ",", "Kcrit"}], "}"}]}], "}"}], "]"}]}], "}"}], 
     "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<K\>\"", ",", "\"\<\!\(\*SubscriptBox[\(R\), \(M\)]\)(K)\>\""}], 
     "}"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.629464737163651*^9, 3.6294647744588327`*^9}, {
  3.6294648107642384`*^9, 3.629464827322446*^9}, {3.629464920751273*^9, 
  3.6294649209537983`*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Join", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Rtab", "[", 
         RowBox[{"L", ",", "\"\<hamiltonian\>\"", ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", 
          RowBox[{"Drop", "[", 
           RowBox[{"Lvals", ",", "2"}], "]"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R", "[", "K", "]"}], ",", 
       RowBox[{"Rl", "[", "K", "]"}], ",", 
       RowBox[{"Rg", "[", "K", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Thick", ",", "Black"}], "}"}]}], "}"}]}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Gray", ",", "Dashed", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Kcrit", ",", 
            RowBox[{"-", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Kcrit", ",", "Kcrit"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "Kcrit"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Kcrit", ",", "Kcrit"}], "}"}]}], "}"}], "]"}]}], "}"}], 
     "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<K\>\"", ",", "\"\<\!\(\*SubscriptBox[\(R\), \(H\)]\)(K)\>\""}], 
     "}"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6289960252931633`*^9, 3.628996032273924*^9}, {
   3.628996118384198*^9, 3.62899614823147*^9}, {3.628996214158305*^9, 
   3.6289962143820877`*^9}, 3.629021203481427*^9, 3.629029177340681*^9, {
   3.629031186253504*^9, 3.629031291959606*^9}, {3.629031539854928*^9, 
   3.629031587522162*^9}, 3.629140425673709*^9, 3.629221607255537*^9, {
   3.629221790683979*^9, 3.6292218187232018`*^9}, {3.629286982245152*^9, 
   3.629286989009398*^9}, 3.6292870773805227`*^9, 3.629464705738934*^9, {
   3.629464927745822*^9, 3.629464927947307*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Join", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Rtab", "[", 
         RowBox[{"L", ",", "\"\<hamiltonian\>\"", ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", 
          RowBox[{"Take", "[", 
           RowBox[{"Lvals", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R", "[", "K", "]"}], ",", 
       RowBox[{"Rl", "[", "K", "]"}], ",", 
       RowBox[{"Rg", "[", "K", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Thick", ",", "Black"}], "}"}]}], "}"}]}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Gray", ",", "Dashed", ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Kcrit", ",", 
            RowBox[{"-", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Kcrit", ",", "Kcrit"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "Kcrit"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Kcrit", ",", "Kcrit"}], "}"}]}], "}"}], "]"}]}], "}"}], 
     "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<K\>\"", ",", "\"\<\!\(\*SubscriptBox[\(R\), \(H\)]\)(K)\>\""}], 
     "}"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.629464795923223*^9, 3.6294648231160297`*^9}, {
   3.629464933813596*^9, 3.629464934030457*^9}, 3.629464971997991*^9, {
   3.6294650322663593`*^9, 3.629465099260453*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1288, 611},
WindowMargins->{{10, Automatic}, {Automatic, 52}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 11, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 93, 1, 64, "Section"],
Cell[675, 25, 79, 1, 28, "Input"],
Cell[757, 28, 732, 13, 28, "Input"],
Cell[1492, 43, 289, 7, 28, "Input"],
Cell[1784, 52, 189, 3, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2010, 60, 92, 1, 64, "Section"],
Cell[2105, 63, 540, 12, 46, "Input"],
Cell[2648, 77, 327, 9, 46, "Input"],
Cell[2978, 88, 335, 9, 46, "Input"],
Cell[3316, 99, 498, 9, 28, "Input"],
Cell[3817, 110, 3855, 89, 199, "Input"],
Cell[7675, 201, 3600, 78, 165, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11312, 284, 143, 2, 64, "Section"],
Cell[11458, 288, 2997, 81, 148, "Input"],
Cell[14458, 371, 913, 18, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15408, 394, 191, 3, 64, "Section"],
Cell[15602, 399, 946, 22, 63, "Input"],
Cell[CellGroupData[{
Cell[16573, 425, 158, 2, 44, "Subsection"],
Cell[16734, 429, 3305, 69, 114, "Input"],
Cell[20042, 500, 3837, 88, 114, "Input"],
Cell[23882, 590, 2446, 69, 114, "Input"],
Cell[26331, 661, 2880, 75, 114, "Input"],
Cell[29214, 738, 2466, 69, 114, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

